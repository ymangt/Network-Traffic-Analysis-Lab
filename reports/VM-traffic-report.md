# Network Traffic Analysis Report – VM Advanced Capture

## Overview
This report documents HTTP traffic and port scan simulations captured on the Test-Machine VM using Wireshark. The objectives were to assess unencrypted HTTP risks from an Apache server and detect reconnaissance threats via a port scan.

## Capture Environment
- **System**: Virtual Machine (Test-Machine, Ubuntu)
- **Purpose**: Capture HTTP traffic from Apache and simulate a port scan.
- **Network Interface**: VMware NAT adapter (VMnet8)
- **Capture Tool**: Wireshark

## Packet Details
### HTTP Traffic (Apache Capture)
- **Packet Count**: 2 packets (request and response).
- **Protocols Detected**: Ethernet II → IPv4 → TCP → HTTP.
- **Request**: HTTP GET `/` to connectivity-check.ubuntu.com (Port 80).
- **Response**: HTTP/1.1 204 No Content from nginx/1.14.0 (Ubuntu), likely a connectivity check.
- **Vulnerability Identified**: Unencrypted HTTP request and response, allowing inspection of headers and server details.
- **Data Visibility**: Host header, method, and server banner (e.g., "nginx/1.14.0") are exposed.

### Port Scan Simulation (ICMPv6 Capture)
- **Packet Count**: 9 ICMPv6 packets (Frames 65, 69, 70, 72, 74, 76, 78, 80, 82).
- **Protocols Detected**: Ethernet II → IPv6 → ICMPv6.
- **Message Type**: Multicast Listener Report Message v2.
- **Source Address**: Link-local IPv6 address fe80::ab87:6af:5ca8:b84e.
- **Destination Address**: IPv6 multicast address ff02::16.
- **Packet Length**: 90 bytes (720 bits) each.
- **Trigger Cause**: Generated by the IPv6 stack during the `sudo nmap -p- localhost` scan, indicating network activity and group membership updates.
- **Vulnerability Identified**: Low risk; link-local addresses could be leveraged for reconnaissance in specific scenarios.
- **Data Visibility**: Reveals IPv6 network presence and configuration.

## Security Risks
- **Unencrypted HTTP**: Headers and potential content are readable, vulnerable to interception.
- **Port Scan Exposure**: Open ports (80, 631) and ICMPv6 data indicate potential entry points and network details for exploitation.
- **Impact**: Enables man-in-the-middle attacks on HTTP and reconnaissance for further threats.

## Mitigation Recommendations
- **Migrate to HTTPS**: Implement TLS certificates (e.g., Let’s Encrypt) to encrypt HTTP traffic.
- **Close Unused Ports**: Use firewall rules (e.g., `sudo ufw deny 631`) to block port 631.
- **IPv6 Hardening**: Disable IPv6 (`sudo sysctl -w net.ipv6.conf.all.disable_ipv6=1`) if not required, or filter ICMPv6 with firewall rules.
- **Network Monitoring**: Deploy Zeek or Suricata to detect abnormal ICMPv6 or port scan patterns.

## Lessons Learned
- Mastered VM configuration, Apache setup, and Nmap usage for traffic simulation.
- Resolved ARP-only captures by selecting the correct Wireshark interface and adapted to ICMPv6 traffic.
- Understood that port scans generate auxiliary protocol traffic (e.g., ICMPv6), providing network intel to attackers.
- Gained awareness of IPv6 multicast behavior, emphasizing the need for selective protocol use.
- Future Work: Simulate XSS and automate threat detection with scripts.

## Conclusion
The VM captures confirm unencrypted HTTP vulnerabilities and the reconnaissance potential of port scans, including ICMPv6 activity. Implementing TLS, firewall rules, and IPv6 hardening is critical, with further simulations (e.g., XSS) planned to enhance threat analysis.
