# Network Traffic Analysis Report – VM Advanced Capture (Final)

## Overview
This report documents multiple network traffic captures conducted on the **Test-Machine** virtual machine (Ubuntu) using Wireshark.  
The objectives were to:  
1. Assess unencrypted HTTP risks from an Apache server.  
2. Detect reconnaissance activity via a simulated port scan.  
3. Demonstrate an application-layer vulnerability with a reflected Cross-Site Scripting (XSS) simulation.  
4. Simulate a denial-of-service (DoS) attack via SYN flooding.  
5. Capture **FTP credentials in cleartext** to highlight legacy protocol risk.

This phase follows the **Basic Host HTTP Capture** and represents the advanced stage of the Network Traffic Analysis with Wireshark project.

---

## Capture Environment
- **System:** Virtual Machine (Test-Machine, Ubuntu)
- **Purpose:** Capture normal HTTP traffic, reconnaissance activity, exploitation attempts, DoS behaviour, and legacy-protocol credential exposure.
- **Network Interface:** VMware NAT adapter (VMnet8)
- **Capture Tool:** Wireshark
- **Capture Dates:** August 10–11, 2025
- **Network Context:** Internal lab environment, isolated from production traffic.

---

## Packet Details

### 1) HTTP Traffic (Apache Capture)
- **Date/Time:** 2025-08-10 (see packet timestamps)
- **Packet Count:** 2 packets (Frames 6 and 8).
- **Protocols Detected:** Ethernet II → IPv4 → TCP → HTTP.
- **Request (Frame 6):** HTTP GET `/` to `connectivity-check.ubuntu.com` (Port 80).
- **Response (Frame 8):** HTTP/1.1 204 No Content from `nginx/1.14.0 (Ubuntu)`, likely part of a system connectivity check.
- **Vulnerability Identified:** Traffic is transmitted in cleartext, allowing full inspection of HTTP headers.
- **Data Visibility:** Host header, HTTP method, and server banner are fully visible.
- **Useful Filter:** `http`

---

### 2) Port Scan Simulation (ICMPv6 Capture)
- **Date/Time:** 2025-08-10 (see packet timestamps)
- **Packet Count:** 9 ICMPv6 packets (Frames 65, 69, 70, 72, 74, 76, 78, 80, 82).
- **Protocols Detected:** Ethernet II → IPv6 → ICMPv6.
- **Message Type:** Multicast Listener Report Message v2.
- **Source Address:** Link-local IPv6 `fe80::ab87:6af:5ca8:b84e`.
- **Destination Address:** IPv6 multicast `ff02::16`.
- **Packet Length:** 90 bytes (720 bits) each.
- **Trigger Cause:** Generated by the IPv6 stack during:
  ```bash
  sudo nmap -p- localhost

**Vulnerability Identified:** Low risk in lab; link-local data can aid reconnaissance in untrusted networks.  
**Useful Filter:** `icmpv6`

---

### 3) XSS Simulation (HTTP Capture)
**Date/Time:** 2025-08-10 (see packet timestamps)

- **Packet Count:** 4 packets (Frames 4, 6, 18, 20).
- **Protocols Detected:** Ethernet II → IPv4 → TCP → HTTP.
- **Request:** HTTP GET `/test.html` and subsequent GET with query parameter (`input=asd`) over port 80.
- **Response:** HTTP/1.1 200 OK containing an HTML form and an injected JavaScript payload:

    <script>alert('XSS Attack Simulated');</script>

- **Vulnerability Identified:** Reflected Cross-Site Scripting (XSS) — server returned unsanitized user input containing JavaScript.
- **Impact:** Arbitrary JavaScript execution in the client’s browser (data theft, session hijacking, content manipulation).
- **Useful Filters:** `http` and `tcp.port == 80`

---

### 4) SYN Flood (DDoS Simulation)
**Date/Time:** 2025-08-10 (see packet timestamps)

- **Packet Count:** Dozens of TCP SYN packets within milliseconds (Frames 1–29 in capture snippet).
- **Protocols Detected:** Ethernet II → IPv4 → TCP.
- **Target:** `192.168.71.131`, Port 80 (Apache HTTP server).
- **Attack Characteristics:**
  - Extremely high rate of SYN packets without completing TCP handshakes.
  - Randomized source IP addresses (e.g., `113.30.150.198`, `30.11.18.156`, `76.34.171.153`).
  - Server replies with SYN/ACKs but receives no ACK → half-open connections.
- **Vulnerability Identified:** DoS risk via TCP connection table exhaustion.
- **Useful Filters:**
  - `tcp.flags.syn == 1 and tcp.flags.ack == 0`
  - `tcp.port == 80`

---

### 5) FTP Credential Capture (Cleartext Authentication)
**Date/Time:** 2025-08-11 (see packet timestamps)

- **Packet Count:** 8 FTP control packets (example frames 4–27).
- **Endpoints:** Client `192.168.71.131` ↔ Server `192.168.71.1` (control channel on TCP/21).
- **Protocols Detected:** Ethernet II → IPv4 → TCP → FTP.
- **Evidence (Control Channel):**
  - `Response: 220 (vsFTPd 3.0.5)`
  - `Request: USER ftpuser`
  - `Request: PASS pass123`
  - `Response: 230 Login successful`
  - `Request: QUIT` → `Response: 221 Goodbye`
- **Vulnerability Identified:** FTP transmits credentials **in plaintext**, making them trivially interceptable.
- **Impact:** Credential theft → unauthorized access, lateral movement, data exposure.
- **Useful Filters:**
  - Display: `ftp || ftp-data`
  - Credentials only: `ftp.request.command == "USER" || ftp.request.command == "PASS"`

---

## Threat Impact Summary

| Threat                       | Risk Level | Likelihood | Severity | Potential Impact                           |
|-----------------------------|------------|------------|----------|--------------------------------------------|
| Unencrypted HTTP            | High       | High       | High     | Credential theft, MITM, data tampering     |
| Port Scan Exposure (ICMPv6) | Low        | Medium     | Low      | Network reconnaissance                      |
| Reflected XSS (HTTP)        | High       | High       | High     | Session hijacking, data theft               |
| SYN Flood (DDoS)            | High       | High       | High     | Service outage, denial of access            |
| FTP Cleartext Credentials   | High       | High       | High     | Account compromise, lateral movement, exposure |

---

## Security Risks
- **Unencrypted HTTP:** Makes all transmitted data susceptible to interception.  
- **Port Scan Exposure:** Reveals open ports (e.g., 80, 631) and IPv6 multicast activity useful for targeting.  
- **XSS Exploitation:** Enables attacker-controlled script execution in the browser.  
- **SYN Flood:** Can overwhelm server resources, leading to service unavailability.  
- **FTP Cleartext Auth:** Credentials (`USER`/`PASS`) are visible on the wire, enabling rapid compromise.  
- **Combined Risk:** Lack of transport encryption and input sanitization compound overall severity.

---

## Mitigation Recommendations
- **Migrate to HTTPS:** Use TLS certificates (e.g., Let’s Encrypt) to encrypt HTTP communications.  
- **Close Unused Ports:** Block unnecessary services (e.g., `sudo ufw deny 631`).  
- **IPv6 Hardening:** Disable IPv6 where not needed or restrict ICMPv6 with firewall rules.  
- **Input Validation & Output Encoding:** Prevent XSS by sanitizing inputs and encoding outputs.  
- **SYN Flood Protection:** Enable SYN cookies and apply rate limiting (e.g., iptables).  
- **Replace FTP:** Use **SFTP (SSH)** or **FTPS (TLS)**; disable `vsftpd` when not required.  
- **Security Testing:** Use OWASP ZAP, Burp Suite, and Nmap in CI or regular assessments.  
- **Network Monitoring:** Deploy IDS/IPS tools (Zeek, Suricata) to flag reconnaissance, exploitation, and DoS patterns.

---

## Lessons Learned
- Progressed from host-only capture to advanced VM-based simulations across multiple attack classes.  
- Identified the attack lifecycle: **Normal → Recon → Exploitation → DoS → Credential Theft**.  
- Understood that unencrypted transport dramatically magnifies application-layer risk.  
- Built practical skill with Wireshark across **HTTP, IPv4/IPv6, ICMPv6, TCP SYN, FTP**.  
- Prepared to extend the lab with covert exfiltration (e.g., DNS/ICMP tunnels) if needed.

---

## Conclusion
This advanced analysis confirms that:

- **Transport-layer encryption is essential** — HTTP over port 80 exposes content and enables manipulation.  
- **Service exposure enables reconnaissance** — open ports and IPv6 data guide targeted attacks.  
- **Application flaws multiply risks** — XSS becomes more dangerous over unencrypted links.  
- **DoS disrupts availability** — SYN floods can exhaust server resources quickly.  
- **Legacy protocols leak credentials** — FTP makes account compromise trivial.

Implementing encryption, service hardening, secure coding, DoS protections, and replacing legacy protocols substantially reduces risk.  
The project demonstrates detection and analysis from normal traffic through reconnaissance, exploitation, DoS, and credential theft—aligned with practical Security+ Domain 2 objectives.

---

## Related Screenshots
- **Apache HTTP Capture:** `screenshots/apache-204-screenshot.png`, `screenshots/apache-get-screenshot.png`  
- **ICMPv6 Port Scan:** `screenshots/port-scan-ICMP-packets-screenshot.png`  
- **XSS Simulation:** `screenshots/XSS-simulated-attack-screenshot.png`  
- **SYN Flood Simulation:** `screenshots/SYN-flood-simulated-attack-screenshot.png`  
- **FTP Credential Capture:** `screenshots/FTP-credential-capture-screenshot.png`
